{"version":3,"file":"blacklight.js","sources":["../../../javascript/blacklight/core.js","../../../javascript/blacklight/checkbox_submit.js","../../../javascript/blacklight/bookmark_toggle.js","../../../javascript/blacklight/button_focus.js","../../../javascript/blacklight/facet_load.js","../../../javascript/blacklight/modal.js","../../../javascript/blacklight/search_context.js","../../../javascript/blacklight/index.js"],"sourcesContent":["const Blacklight = function() {\n  var buffer = new Array;\n  return {\n    onLoad: function(func) {\n      buffer.push(func);\n    },\n\n    activate: function() {\n      for(var i = 0; i < buffer.length; i++) {\n        buffer[i].call();\n      }\n    },\n\n    listeners: function () {\n      var listeners = [];\n      if (typeof Turbo !== 'undefined') {\n        listeners.push('turbo:load');\n      } else if (typeof Turbolinks !== 'undefined' && Turbolinks.supported) {\n        // Turbolinks 5\n        if (Turbolinks.BrowserAdapter) {\n          listeners.push('turbolinks:load');\n        } else {\n          // Turbolinks < 5\n          listeners.push('page:load', 'DOMContentLoaded');\n        }\n      } else {\n        listeners.push('DOMContentLoaded');\n      }\n\n      return listeners;\n    }\n  };\n}();\n\n// turbolinks triggers page:load events on page transition\n// If app isn't using turbolinks, this event will never be triggered, no prob.\nBlacklight.listeners().forEach(function(listener) {\n  document.addEventListener(listener, function() {\n    Blacklight.activate()\n  })\n})\n\nBlacklight.onLoad(function () {\n  const elem = document.querySelector('.no-js');\n\n  // The \"no-js\" class may already have been removed because this function is\n  // run on every turbo:load event, in that case, it won't find an element.\n  if (!elem) return;\n\n  elem.classList.remove('no-js')\n  elem.classList.add('js')\n})\n\n\nexport default Blacklight\n","/* Converts a \"toggle\" form, with single submit button to add/remove\n   something, like used for Bookmarks, into an AJAXy checkbox instead.\n   Apply to a form. Does require certain assumption about the form:\n    1) The same form 'action' href must be used for both ADD and REMOVE\n       actions, with the different being the hidden input name=\"_method\"\n       being set to \"put\" or \"delete\" -- that's the Rails method to pretend\n       to be doing a certain HTTP verb. So same URL, PUT to add, DELETE\n       to remove. This plugin assumes that.\n       Plus, the form this is applied to should provide a data-doc-id\n       attribute (HTML5-style doc-*) that contains the id/primary key\n       of the object in question -- used by plugin for a unique value for\n       DOM id's.\n  Uses HTML for a checkbox compatible with Bootstrap 4.\n   new CheckboxSubmit(document.querySelector('form.something')).render()\n*/\nexport default class CheckboxSubmit {\n  constructor(form) {\n    this.form = form\n    this.cssClass = 'toggle-bookmark'\n\n    //View needs to set data-doc-id so we know a unique value\n    //for making DOM id\n    const uniqueId = this.form.getAttribute('data-doc-id') || Math.random();\n    const id = `${this.cssClass}_${uniqueId}`\n    this.checkbox = this._buildCheckbox(this.cssClass, id)\n    this.span = this._buildSpan()\n    this.label = this._buildLabel(id, this.cssClass, this.checkbox, this.span)\n\n    // if form is currently using method delete to change state,\n    // then checkbox is currently checked\n    this.checked = (this.form.querySelectorAll('input[name=_method][value=delete]').length != 0);\n  }\n\n  _buildCheckbox(cssClass, id) {\n    const checkbox = document.createElement('input')\n    checkbox.setAttribute('type', 'checkbox')\n    checkbox.classList.add(cssClass)\n    checkbox.id = id\n    return checkbox\n  }\n\n  _buildLabel(id, cssClass, checkbox, span) {\n    const label = document.createElement('label')\n    label.classList.add(cssClass)\n    label.for = id\n\n    label.appendChild(checkbox)\n    label.appendChild(document.createTextNode(' '))\n    label.appendChild(span)\n    return label\n  }\n\n  _buildSpan() {\n    return document.createElement('span')\n  }\n\n  _buildCheckboxDiv() {\n    const checkboxDiv = document.createElement('div')\n    checkboxDiv.classList.add('checkbox')\n    checkboxDiv.classList.add(this.cssClass)\n    checkboxDiv.appendChild(this.label)\n    return checkboxDiv\n  }\n\n  render() {\n    const children = this.form.children\n    Array.from(children).forEach((child) => child.classList.add('hidden'))\n\n    //We're going to use the existing form to actually send our add/removes\n    //This works conveneintly because the exact same action href is used\n    //for both bookmarks/$doc_id.  But let's take out the irrelevant parts\n    //of the form to avoid any future confusion.\n    this.form.querySelectorAll('input[type=submit]').forEach((el) => this.form.removeChild(el))\n    this.form.appendChild(this._buildCheckboxDiv())\n    this.updateStateFor(this.checked)\n\n    this.checkbox.onclick = this._clicked.bind(this)\n  }\n\n  async _clicked(evt) {\n    this.span.innerHTML = this.form.getAttribute('data-inprogress')\n    this.label.setAttribute('disabled', 'disabled');\n    this.checkbox.setAttribute('disabled', 'disabled');\n    const response = await fetch(this.form.getAttribute('action'), {\n      body: new FormData(this.form),\n      method: this.form.getAttribute('method').toUpperCase(),\n      headers: {\n        'Accept': 'application/json',\n        'X-Requested-With': 'XMLHttpRequest'\n      }\n    })\n    this.label.removeAttribute('disabled')\n    this.checkbox.removeAttribute('disabled')\n    if (response.ok) {\n      const json = await response.json()\n      this.checked = !this.checked\n      this.updateStateFor(this.checked)\n      document.querySelector('[data-role=bookmark-counter]').innerHTML = json.bookmarks.count\n    } else {\n      alert('Error')\n    }\n  }\n\n  updateStateFor(state) {\n    this.checkbox.checked = state\n\n    if (state) {\n      this.label.classList.add('checked')\n      //Set the Rails hidden field that fakes an HTTP verb\n      //properly for current state action.\n      this.form.querySelector('input[name=_method]').value = 'delete'\n      this.span.innerHTML = this.form.getAttribute('data-present')\n    } else {\n      this.label.classList.remove('checked')\n      this.form.querySelector('input[name=_method]').value = 'put'\n      this.span.innerHTML = this.form.getAttribute('data-absent')\n    }\n  }\n}\n","import Blacklight from './core'\nimport CheckboxSubmit from './checkbox_submit'\n\nconst BookmarkToggle = (() => {\n    // change form submit toggle to checkbox\n    Blacklight.doBookmarkToggleBehavior = function() {\n      document.querySelectorAll(Blacklight.doBookmarkToggleBehavior.selector).forEach((el) => {\n        new CheckboxSubmit(el).render()\n      })\n    };\n    Blacklight.doBookmarkToggleBehavior.selector = 'form.bookmark-toggle';\n\n    Blacklight.onLoad(function() {\n      Blacklight.doBookmarkToggleBehavior();\n    });\n})()\n\nexport default BookmarkToggle\n","import Blacklight from './core'\n\nconst ButtonFocus = (() => {\n  Blacklight.onLoad(function() {\n    // Button clicks should change focus. As of 10/3/19, Firefox for Mac and\n    // Safari both do not set focus to a button on button click.\n    // See https://zellwk.com/blog/inconsistent-button-behavior/ for background information\n    document.querySelectorAll('button.collapse-toggle').forEach((button) => {\n      button.addEventListener('click', () => {\n        event.target.focus();\n      });\n    });\n  });\n})()\n\nexport default ButtonFocus\n","import Blacklight from './core'\n\nBlacklight.doResizeFacetLabelsAndCounts = function() {\n  // adjust width of facet columns to fit their contents\n  function longer (a,b) { return b.textContent.length - a.textContent.length }\n\n  document.querySelectorAll('.facet-values, .pivot-facet').forEach(function(elem){\n    const nodes = elem.querySelectorAll('.facet-count')\n    // TODO: when we drop ie11 support, this can become the spread operator:\n    const longest = Array.from(nodes).sort(longer)[0]\n    if (longest && longest.textContent) {\n      const width = longest.textContent.length + 1 + 'ch'\n      elem.querySelector('.facet-count').style.width = width\n    }\n  })\n}\n\nconst FacetLoad = (() => {\n  Blacklight.onLoad(function() {\n    Blacklight.doResizeFacetLabelsAndCounts()\n  })\n})()\n\nexport default FacetLoad\n","/*\n  The blacklight modal plugin can display some interactions inside a Bootstrap\n  modal window, including some multi-page interactions.\n\n  It supports unobtrusive Javascript, where a link or form that would have caused\n  a new page load is changed to display it's results inside a modal dialog,\n  by this plugin.  The plugin assumes there is a Bootstrap modal div\n  on the page with id #blacklight-modal to use as the modal -- the standard Blacklight\n  layout provides this.\n\n  To make a link or form have their results display inside a modal, add\n  `data-blacklight-modal=\"trigger\"` to the link or form. (Note, form itself not submit input)\n  With Rails link_to helper, you'd do that like:\n\n      link_to something, link, data: { blacklight_modal: \"trigger\" }\n\n  The results of the link href or form submit will be displayed inside\n  a modal -- they should include the proper HTML markup for a bootstrap modal's\n  contents. Also, you ordinarily won't want the Rails template with wrapping\n  navigational elements to be used.  The Rails controller could suppress\n  the layout when a JS AJAX request is detected, OR the response\n  can include a `<div data-blacklight-modal=\"container\">` -- only the contents\n  of the container will be placed inside the modal, the rest of the\n  page will be ignored.\n\n  Link or forms inside the modal will ordinarily cause page loads\n  when they are triggered. However, if you'd like their results\n  to stay within the modal, just add `data-blacklight-modal=\"preserve\"`\n  to the link or form.\n\n  Here's an example of what might be returned, demonstrating most of the devices available:\n\n    <div data-blacklight-modal=\"container\">\n      <div class=\"modal-header\">\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">Ã—</button>\n        <h3 class=\"modal-title\">Request Placed</h3>\n      </div>\n\n      <div class=\"modal-body\">\n        <p>Some message</p>\n        <%= link_to \"This result will still be within modal\", some_link, data: { blacklight_modal: \"preserve\" } %>\n      </div>\n\n\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n      </div>\n    </div>\n\n\n  One additional feature. If the content returned from the AJAX form submission\n  can be a turbo-stream that defines some HTML fragementsand where on the page to put them:\n  https://turbo.hotwired.dev/handbook/streams\n*/\nimport Blacklight from './core'\nimport ModalForm from './modalForm'\n\nconst Modal = (() => {\n  // We keep all our data in Blacklight.modal object.\n  // Create lazily if someone else created first.\n  if (Blacklight.modal === undefined) {\n    Blacklight.modal = {};\n  }\n\n  const modal = Blacklight.modal\n\n  // a Bootstrap modal div that should be already on the page hidden\n  modal.modalSelector = '#blacklight-modal';\n\n  // Trigger selectors identify forms or hyperlinks that should open\n  // inside a modal dialog.\n  modal.triggerLinkSelector  = 'a[data-blacklight-modal~=trigger]';\n\n  // preserve selectors identify forms or hyperlinks that, if activated already\n  // inside a modal dialog, should have destinations remain inside the modal -- but\n  // won't trigger a modal if not already in one.\n  //\n  // No need to repeat selectors from trigger selectors, those will already\n  // be preserved. MUST be manually prefixed with the modal selector,\n  // so they only apply to things inside a modal.\n  modal.preserveLinkSelector = modal.modalSelector + ' a[data-blacklight-modal~=preserve]';\n\n  modal.containerSelector    = '[data-blacklight-modal~=container]';\n\n  // Called on fatal failure of ajax load, function returns content\n  // to show to user in modal.  Right now called only for extreme\n  // network errors.\n  modal.onFailure = function(jqXHR, textStatus, errorThrown) {\n      console.error('Server error:', this.url, jqXHR.status, errorThrown);\n\n      const contents = `<div class=\"modal-header\">\n        <div class=\"modal-title\">There was a problem with your request.</div>\n        <button type=\"button\" class=\"blacklight-modal-close btn-close close\" data-dismiss=\"modal\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n        </div>\n        <div class=\"modal-body\">\n          <p>Expected a successful response from the server, but got an error</p>\n          <pre>${this.type} ${this.url}\\n${jqXHR.status}: ${errorThrown}</pre>\n        </div>`\n\n      document.querySelector(`${modal.modalSelector} .modal-content`).innerHTML = contents\n\n      modal.show();\n  }\n\n  // Add the passed in contents to the modal and display it.\nmodal.receiveAjax = function (contents) {\n      const domparser = new DOMParser();\n      const dom = domparser.parseFromString(contents, \"text/html\")\n      const elements = dom.querySelectorAll(`${modal.containerSelector} > *`)\n      document.querySelector(`${modal.modalSelector} .modal-content`).replaceChildren(...elements)\n\n      modal.show();\n  };\n\n\n  modal.modalAjaxLinkClick = function(e) {\n    e.preventDefault();\n    const href = e.target.getAttribute('href')\n    fetch(href)\n      .then(response => {\n         if (!response.ok) {\n           throw new TypeError(\"Request failed\");\n         }\n         return response.text();\n       })\n      .then(data => modal.receiveAjax(data))\n      .catch(error => modal.onFailure(error))\n  };\n\n  modal.setupModal = function() {\n    // Register both trigger and preserve selectors in ONE event handler, combining\n    // into one selector with a comma, so if something matches BOTH selectors, it\n    // still only gets the event handler called once.\n    document.addEventListener('click', (e) => {\n      if (e.target.matches(`${modal.triggerLinkSelector}, ${modal.preserveLinkSelector}`))\n        modal.modalAjaxLinkClick(e)\n    })\n  };\n\n  modal.hide = function(el) {\n    if (bootstrap.Modal.VERSION >= \"5\") {\n      bootstrap.Modal.getOrCreateInstance(el || document.querySelector(modal.modalSelector)).hide();\n    } else {\n      $(el || modal.modalSelector).modal('hide');\n    }\n  }\n\n  modal.show = function(el) {\n    if (bootstrap.Modal.VERSION >= \"5\") {\n      bootstrap.Modal.getOrCreateInstance(el || document.querySelector(modal.modalSelector)).show();\n    } else {\n      $(el || modal.modalSelector).modal('show');\n    }\n  }\n\n  Blacklight.onLoad(function() {\n    modal.setupModal();\n  });\n})()\n\nexport default Modal\n","import Blacklight from './core'\n\nconst SearchContext = (() => {\n  Blacklight.doSearchContextBehavior = function() {\n    const elements = document.querySelectorAll('a[data-context-href]')\n    const nodes = Array.from(elements)\n\n    nodes.forEach(function(element) {\n      element.addEventListener('click', function(e) {\n        Blacklight.handleSearchContextMethod.call(e.currentTarget, e)\n      })\n    })\n  };\n\n  Blacklight.csrfToken = () => document.querySelector('meta[name=csrf-token]')?.content\n  Blacklight.csrfParam = () => document.querySelector('meta[name=csrf-param]')?.content\n\n  // this is the Rails.handleMethod with a couple adjustments, described inline:\n  // first, we're attaching this directly to the event handler, so we can check for meta-keys\n  Blacklight.handleSearchContextMethod = function(event) {\n    var link = this\n\n    // instead of using the normal href, we need to use the context href instead\n    let href = link.getAttribute('data-context-href')\n    let target = link.getAttribute('target')\n    let csrfToken = Blacklight.csrfToken()\n    let csrfParam = Blacklight.csrfParam()\n    let form = document.createElement('form')\n    form.method = 'post'\n    form.action = href\n\n\n    let formContent = `<input name=\"_method\" value=\"post\" type=\"hidden\" />\n      <input name=\"redirect\" value=\"${link.getAttribute('href')}\" type=\"hidden\" />`\n\n    // check for meta keys.. if set, we should open in a new tab\n    if(event.metaKey || event.ctrlKey) {\n      target = '_blank';\n    }\n\n    if (csrfParam !== undefined && csrfToken !== undefined) {\n      formContent += `<input name=\"${csrfParam}\" value=\"${csrfToken}\" type=\"hidden\" />`\n    }\n\n    // Must trigger submit by click on a button, else \"submit\" event handler won't work!\n    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit\n    formContent += '<input type=\"submit\" />'\n\n    if (target) { form.setAttribute('target', target); }\n\n    form.style.display = 'none'\n    form.innerHTML = formContent\n    document.body.appendChild(form)\n    form.querySelector('[type=\"submit\"]').click()\n\n    event.preventDefault()\n    event.stopPropagation()\n  };\n\n  Blacklight.onLoad(function() {\n    Blacklight.doSearchContextBehavior();\n  });\n})()\n\nexport default SearchContext\n","import BookmarkToggle from './bookmark_toggle'\nimport ButtonFocus from './button_focus'\nimport FacetLoad from './facet_load'\nimport Modal from './modal'\nimport SearchContext from './search_context'\nimport Core from './core'\n\nexport default {\n  BookmarkToggle,\n  ButtonFocus,\n  FacetLoad,\n  Modal,\n  SearchContext,\n  onLoad: Core.onLoad\n}\n"],"names":["Core"],"mappings":"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"}